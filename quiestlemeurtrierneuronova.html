<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Cyber Mystery : Le Sabotage de NeuroNova !</title>
    <style>
        :root {
            --main-color: #00ff00;
            --border-color: #009900;
            --bg-color: #1a1a1a;
            --container-bg: #222;
            --header-bg: #333;
            --code-color: #ffff00;
            --indice-color: #ff9900;
            --final-button-color: #ff4136; /* Rouge pour le bouton final */
            --final-button-hover-color: #e03a2f;
        }
        body {
            font-family: 'Courier New', monospace;
            background-color: var(--bg-color);
            color: var(--main-color);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: var(--container-bg);
            padding: 30px;
            border: 1px solid var(--main-color);
            box-shadow: 0 0 10px var(--main-color);
        }
        h1, h2, h3 {
            color: #00cc00;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 5px;
        }
        .image-header {
            width: 100%;
            height: auto;
            margin-bottom: 20px;
            border: 1px solid var(--main-color);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid var(--border-color);
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: var(--header-bg);
            color: var(--main-color);
        }
        pre {
            background-color: #000;
            color: var(--code-color);
            padding: 15px;
            overflow-x: auto;
            border: 1px dashed var(--border-color);
            border-radius: 4px;
        }
        .indice {
            color: var(--indice-color);
            font-weight: bold;
        }
        .schema-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .schema-table {
            background-color: #111;
            border: 1px solid var(--border-color);
            padding: 15px;
        }
        .schema-table h4 {
            margin: 0 0 10px 0;
            padding-bottom: 5px;
            border-bottom: 1px solid var(--border-color);
        }
        .schema-table ul {
            list-style: none;
            padding: 0;
            margin: 0;
            font-size: 0.9em;
        }
        .key-info {
            color: #aaa;
        }
        .solution-title {
            cursor: pointer;
            font-weight: bold;
            color: var(--indice-color);
            border: 1px solid var(--indice-color);
            padding: 10px;
            margin-top: 15px;
            transition: background-color 0.3s;
            display: block; /* Pour occuper toute la largeur */
            text-align: center;
        }
        .solution-title:hover {
            background-color: #333;
        }
        .solution-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out, padding 0.5s ease-in-out;
            padding: 0 15px;
            background-color: #111;
            border-left: 2px solid var(--indice-color);
        }
        .solution-content.active {
            padding: 15px;
        }
        /* Styles sp√©cifiques pour le bouton final */
        #final-clue-button {
            background-color: var(--final-button-color);
            color: white;
            border-color: var(--final-button-color);
            font-size: 1.1em;
            padding: 12px;
            margin-top: 30px; /* Plus d'espace au-dessus */
            box-shadow: 0 0 8px var(--final-button-color); /* Ombre pour l'accentuer */
        }
        #final-clue-button:hover {
            background-color: var(--final-button-hover-color);
            box-shadow: 0 0 12px var(--final-button-color);
        }
        #final-clue-button.clicked-1 {
            background-color: #ff8c00; /* Orange apr√®s le 1er clic */
            border-color: #ff8c00;
        }
        #final-clue-button.clicked-2 {
            background-color: #ffd700; /* Jaune apr√®s le 2√®me clic */
            border-color: #ffd700;
            color: #333; /* Texte sombre pour le contraste */
        }
        .warning-message {
            margin-top: 10px;
            padding: 10px;
            border: 1px dashed #ff4136;
            background-color: #330000; /* Fond l√©g√®rement plus sombre */
            color: #ff4136;
            font-style: italic;
            text-align: center;
            /* Nouveau : par d√©faut cach√© et affich√© via JS pour empiler */
            display: none; 
        }
        .fun-fact {
            color: #7FDBFF; /* Bleu clair pour le fun fact */
            font-size: 0.9em;
            margin-top: 5px;
        }
        .final-answer {
            background-color: var(--header-bg);
            border: 2px solid var(--indice-color);
            padding: 15px;
            margin-top: 15px;
            font-size: 1.2em;
            text-align: center;
        }
        a {
            font-weight: bold;
            color: yellow;
        }
    </style>
</head>
<body>

    <div class="container">

        <img src="https://mystery.knightlab.com/174092-clue-illustration.png" alt="Illustration de d√©tective et d'indices" class="image-header">

        <h1>üîç SQL Cyber Mystery : Le Sabotage de NeuroNova !</h1>

        <p>Bienvenue, d√©tective virtuel ! Dans ce jeu, vos comp√©tences en <b>SQL</b> (Structured Query Language) sont votre seule arme pour percer un myst√®re de haute technologie. Des enregistrements contienne les indices qui vous permettront de remonter la piste du coupable. Oubliez la loupe üîç, sortez votre clavier üíª !</p>

        <h2>üïµÔ∏è‚Äç‚ôÇÔ∏è Le Myst√®re</h2>
        <table>
            <tbody>
                <tr><td><b>QUOI ?</b></td><td>Sabotage interne et vol de propri√©t√© intellectuelle, avec un d√©c√®s suspect.</td></tr>
                <tr><td><b>QUAND ?</b></td><td>La nuit du <b>15 au 16 Octobre 2025</b>.</td></tr>
                <tr><td><b>O√ô ?</b></td><td>Au si√®ge de <b>NeuroNova Analytics</b>, une start-up IA √† Paris.</td></tr>
                <tr><td><b>VICTIME :</b></td><td>Dr. Aris Thorne, architecte en chef de "Project Chimera", retrouv√© sans vie.</td></tr>
                <tr><td><b>VOL :</b></td><td>Le code source de "Project Chimera", une IA de pr√©diction √©motionnelle, a disparu.</td></tr>
            </tbody>
        </table>
        <p>Le Dr. Aris Thorne a √©t√© retrouv√© mort dans la salle serveur. Les logs de s√©curit√© ont √©t√© partiellement effac√©s et le code source de "Project Chimera" a √©t√© vol√©. Votre mission : fouiller dans les enregistrements num√©riques de l'entreprise et d√©masquer le coupable.</p>
        <hr>

        <h2>üöÄ Pr√©paration de l'environnement d'enqu√™te</h2>
        <p>Pour r√©aliser la mission, vous pouvez utiliser l'Interpr√©teur SQL de Synapse Learners √† cette adresse : <a href="https://www.synapselearners.com/interpreteursql" target="_blank">https://www.synapselearners.com/interpreteursql</a>.</p>
        <p>Vous pouvez √©galement utiliser <b>DuckDB</b> avec Pandas de cette fa√ßon :</p>
        <pre><code>
            # Importation des biblioth√®ques n√©cessaires
            import duckdb
            import pandas as pd

            # Chargement de chaque fichier CSV dans un DataFrame pandas
            table_client = pd.read_csv("https://www.table_client.com")
            table_fournisseur = pd.read_csv("https://table_fournisseur.com")

            duckdb.sql("""
                select * from table_client;
            """).df()
        </code></pre>
        <p>Voici les URL des tables au format CSV :</p>
        <pre><code>URL_EMPLOYES.csv : https://raw.githubusercontent.com/Patrick-Wampe/datasets/refs/heads/main/NEURONOVA_EMPLOYES.csv
URL_ACCES_SERVEURS.csv : https://raw.githubusercontent.com/Patrick-Wampe/datasets/refs/heads/main/NEURONOVA_ACCES_SERVEUR.csv
URL_LOGS_CODE.csv : https://raw.githubusercontent.com/Patrick-Wampe/datasets/refs/heads/main/NEURONOVA_LOGS_CODE.csv
URL_LOGS_RESEAU.csv : https://raw.githubusercontent.com/Patrick-Wampe/datasets/refs/heads/main/NEURONOVA_LOGS_RESEAU.csv
URL_MESSAGERIE_INTERNE.csv : https://raw.githubusercontent.com/Patrick-Wampe/datasets/refs/heads/main/NEURONOVA_MESSAGERIE_INTERNE.csv
URL_ZONES_SECURISEES.csv : https://raw.githubusercontent.com/Patrick-Wampe/datasets/refs/heads/main/NEURONOVA_ZONES_SECURISEES.csv
URL_AGENDA_REUNIONS.csv : https://raw.githubusercontent.com/Patrick-Wampe/datasets/refs/heads/main/NEURONOVA_AGENDA_REUNIONS.csv
</code></pre>

        <hr>

        <h2>üîó Sch√©ma de la base de donn√©es</h2>
        <p>Votre carte du r√©seau de NeuroNova. Utilisez ces informations pour construire vos requ√™tes et naviguer entre les tables.</p>
        <div class="schema-container">
            <div class="schema-table"><h4>EMPLOYES</h4><ul><li><b>employe_id (PK)</b></li><li>nom</li><li>role</li></ul></div>
            <div class="schema-table"><h4>ACCES_SERVEURS</h4><ul><li>log_id (PK)</li><li><b>employe_id (FK)</b></li><li>date_acces</li><li>heure_acces</li></ul></div>
            <div class="schema-table"><h4>LOGS_CODE</h4><ul><li>commit_id (PK)</li><li><b>employe_id (FK)</b></li><li>action</li><li>description</li><li>heure</li></ul></div>
            <div class="schema-table"><h4>LOGS_RESEAU</h4><ul><li>log_id (PK)</li><li><b>employe_id (FK)</b></li><li>donnees_upload_mb</li><li>date_log</li></ul></div>
            <div class="schema-table"><h4>MESSAGERIE_INTERNE</h4><ul><li>message_id (PK)</li><li><b>id_expediteur (FK)</b></li><li>message</li><li>heure</li></ul></div>
            <div class="schema-table"><h4>ZONES_SECURISEES</h4><ul><li><b>zone_id (PK)</b></li><li>nom_zone</li><li>niveau_acces</li></ul></div>
            <div class="schema-table"><h4>AGENDA_REUNIONS</h4><ul><li>reunion_id (PK)</li><li><b>employe_id (FK)</b></li><li><b>zone_id (FK)</b></li><li>sujet</li><li>heure_planifiee</li></ul></div>
        </div>

        <hr>

        <h2>üìù Plan d'enqu√™te</h2>
        <p>Voici ce que les enqu√™teurs vous ont donn√© comme information : <b>Le coupable est parmi les employ√©s pr√©sents dans la salle serveur apr√®s 18:00 le soir du crime (15/10/2025) üïµÔ∏è‚Äç‚ôÇÔ∏è.</b></p>
        
        <hr>

        <h2>‚úÖ Dossier classifi√© : V√©rifier votre solution</h2>
        <p>Une fois votre enqu√™te termin√©e, ou si vous √™tes bloqu√©, consultez les solutions ci-dessous pour valider vos d√©couvertes.</p>

        <div class="solution-title"><b>[CLIC]</b> R√©v√©ler la Requ√™te de l'Indice #1</div>
        <div class="solution-content">
            <p><b>Objectif :</b> Identifier les employ√©s pr√©sents dans la salle serveur apr√®s 18:00.</p>
            <pre><code>SELECT
  ACCES_SERVEURS.employe_id,
  ACCES_SERVEURS.date_acces,
  ACCES_SERVEURS.heure_acces,
  EMPLOYES.nom,
  EMPLOYES.role
FROM ACCES_SERVEURS
JOIN EMPLOYES
  ON ACCES_SERVEURS.employe_id = EMPLOYES.employe_id
WHERE
  ACCES_SERVEURS.date_acces = '2025-10-15' AND ACCES_SERVEURS.heure_acces > '18:00:00';</code></pre>
            <p><b>Explication :</b> Cette requ√™te combine les informations de la table ACCES_SERVEURS avec celles de la table EMPLOYES (JOIN) en utilisant l'ID de l'employ√©. Elle filtre ensuite les enregistrements pour la date du crime ('2025-10-15') et pour les acc√®s apr√®s 18h00 ('18:00:00'). Cela nous donnera une liste de suspects potentiels. R√©sultat attendu : Vous devriez trouver un groupe d'employ√©s qui √©taient encore dans la salle serveur apr√®s 18h. Remarquez que l'employ√© E01 (Dr. Aris Thorne) est sur cette liste avec une activit√© suspecte.</p>
        </div>

        <div class="solution-title"><b>[CLIC]</b> R√©v√©ler la Requ√™te de l'Indice #2</div>
        <div class="solution-content">
            <p><b>Objectif :</b> Trouver qui, parmi les suspects, a effac√© des fichiers.</p>
            <pre><code>SELECT
  LOGS_CODE.employe_id,
  LOGS_CODE.action,
  LOGS_CODE.description,
  LOGS_CODE.heure,
  EMPLOYES.nom,
  EMPLOYES.role
FROM LOGS_CODE
JOIN EMPLOYES
  ON LOGS_CODE.employe_id = EMPLOYES.employe_id
WHERE
  LOGS_CODE.action = 'delete' AND LOGS_CODE.description LIKE '%Effaceur de Traces%';</code></pre>
            <p><b>Explication :</b> Nous recherchons dans la table LOGS_CODE les actions de type 'delete' qui contiennent la description sp√©cifique 'Effaceur de Traces'. Le JOIN avec la table EMPLOYES permet d'obtenir le nom et le r√¥le de l'employ√© concern√©. R√©sultat attendu : Cette requ√™te devrait pointer directement vers un employ√© en particulier qui a tent√© de masquer quelque chose. Vous devriez trouver E01 (Dr. Aris Thorne).</p>
        </div>

        <div class="solution-title"><b>[CLIC]</b> R√©v√©ler la Requ√™te de l'Indice #3</div>
        <div class="solution-content">
            <p><b>Objectif :</b> Identifier l'upload suspect de plus de 800 MB.</p>
            <pre><code>SELECT
  LOGS_RESEAU.employe_id,
  EMPLOYES.nom,
  LOGS_RESEAU.donnees_upload_mb,
  LOGS_RESEAU.date_log
FROM LOGS_RESEAU
JOIN EMPLOYES
  ON LOGS_RESEAU.employe_id = EMPLOYES.employe_id
WHERE
  LOGS_RESEAU.employe_id = 'E02' AND LOGS_RESEAU.donnees_upload_mb > 800 AND LOGS_RESEAU.date_log = '2025-10-15';</code></pre>
            <p><b>Explication :</b> On filtre la table LOGS_RESEAU pour l'employe_id "E02" (Lena Moreau, l'autre suspecte cl√©) et pour les donnees_upload_mb sup√©rieures √† 800, le jour du crime. Un JOIN avec EMPLOYES fournit les d√©tails sur l'employ√©. R√©sultat attendu : Cette requ√™te devrait r√©v√©ler un upload massif effectu√© par l'employ√© E02 (Lena Moreau) le jour du crime, un acte tr√®s suspect √©tant donn√© le vol du code source. Cela transf√®re les soup√ßons de E01 √† E02.</p>
        </div>

        <div class="solution-title"><b>[CLIC]</b> R√©v√©ler la Requ√™te de l'Indice #4</div>
        <div class="solution-content">
            <p><b>Objectif :</b> Trouver le message contenant le mot "Chimera".</p>
            <pre><code>SELECT
  MESSAGERIE_INTERNE.message_id,
  MESSAGERIE_INTERNE.id_expediteur,
  EMPLOYES.nom AS expediteur_nom,
  MESSAGERIE_INTERNE.id_destinataire,
  (SELECT nom FROM EMPLOYES WHERE employe_id = MESSAGERIE_INTERNE.id_destinataire) AS destinataire_nom,
  MESSAGERIE_INTERNE.message,
  MESSAGERIE_INTERNE.heure
FROM MESSAGERIE_INTERNE
JOIN EMPLOYES
  ON MESSAGERIE_INTERNE.id_expediteur = EMPLOYES.employe_id
WHERE
  MESSAGERIE_INTERNE.id_expediteur = 'E02' AND MESSAGERIE_INTERNE.message LIKE '%Chimera%'
ORDER BY
  MESSAGERIE_INTERNE.heure DESC;</code></pre>
            <p><b>Explication :</b> Nous filtrons la table MESSAGERIE_INTERNE pour les messages envoy√©s par l'id_expediteur "E02" (Lena Moreau) qui contiennent le mot "Chimera" (en utilisant LIKE '%Chimera%'). Un JOIN est effectu√© avec EMPLOYES pour obtenir le nom de l'exp√©diteur, et une sous-requ√™te est utilis√©e pour obtenir le nom du destinataire. L'ordre est invers√© pour voir les messages les plus r√©cents en premier. R√©sultat attendu : Vous devriez trouver des messages o√π Lena Moreau (E02) discute du "Project Chimera" avec la victime (Aris Thorne, E01) juste avant l'heure du crime, montrant une certaine urgence ou une tentative de validation tardive.</p>
        </div>

        <div id="final-clue-button" class="solution-title"><b>[CLIC N¬∞1]</b> R√âV√âLER LE COUPABLE</div>
        
        <div id="warning-messages-container">
            <div id="warning-1" class="warning-message">
                <p>Es-tu <b>VRAIMENT</b> s√ªr d'avoir trouv√© le coupable ? C'est une d√©cision lourde de cons√©quences...</p>
                <p class="fun-fact"><b>Le saviez-vous ?</b> Un z√®bre est noir avec des rayures blanches, pas l'inverse. Les rayures sont une forme de camouflage appel√©e "dazzle camouflage".</p>
            </div>
            <div id="warning-2" class="warning-message">
                <p>Derni√®re chance avant de r√©v√©ler la v√©rit√©. Une fois le coupable d√©sign√©, il n'y aura plus de retour en arri√®re. Confirmez-vous ?</p>
                <p class="fun-fact"><b>Le saviez-vous ?</b> La Grande Muraille de Chine n'est pas visible depuis l'espace sans aide optique, contrairement √† la l√©gende populaire.</p>
            </div>
        </div>

        <div id="final-clue-content" class="solution-content">
            <p><b>Objectif :</b> Identifier l'employ√© qui avait une r√©union dans la zone la plus s√©curis√©e avec son meurtrier.</p>
            <pre><code>SELECT
  EMPLOYES.nom,
  EMPLOYES.role,
  AGENDA_REUNIONS.sujet,
  AGENDA_REUNIONS.heure_planifiee,
  ZONES_SECURISEES.nom_zone
FROM EMPLOYES
JOIN AGENDA_REUNIONS
  ON EMPLOYES.employe_id = AGENDA_REUNIONS.employe_id
JOIN ZONES_SECURISEES
  ON AGENDA_REUNIONS.zone_id = ZONES_SECURISEES.zone_id
WHERE
  AGENDA_REUNIONS.employe_id = 'E01' AND ZONES_SECURISEES.niveau_acces = (
    SELECT
      MAX(niveau_acces)
    FROM ZONES_SECURISEES
  ) AND DATE(AGENDA_REUNIONS.heure_planifiee) = '2025-10-15';</code></pre>
            <div class="final-answer">
                <p>Le coupable est : Dr. Aris Thorne par suicide</p>
            </div>
        </div>
        
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Logique pour les accord√©ons simples
            const solutionTitles = document.querySelectorAll('.solution-title:not(#final-clue-button)');
            solutionTitles.forEach(title => {
                title.addEventListener('click', () => {
                    const content = title.nextElementSibling;
                    const isActive = content.classList.contains('active');

                    // Ferme tous les autres accord√©ons
                    document.querySelectorAll('.solution-content.active').forEach(openContent => {
                        if (openContent !== content) {
                            openContent.classList.remove('active');
                            openContent.style.maxHeight = null;
                        }
                    });

                    // Cache tous les messages d'avertissement quand un indice est cliqu√©
                    document.querySelectorAll('.warning-message').forEach(msg => {
                        msg.style.display = 'none';
                    });

                    if (isActive) {
                        content.classList.remove('active');
                        content.style.maxHeight = null;
                    } else {
                        content.classList.add('active');
                        content.style.maxHeight = content.scrollHeight + 'px';
                    }
                });
            });

            // Logique pour le bouton final √† 3 clics
            const finalButton = document.getElementById('final-clue-button');
            const finalContent = document.getElementById('final-clue-content');
            const warningContainer = document.getElementById('warning-messages-container'); // Nouveau conteneur
            const warning1 = document.getElementById('warning-1');
            const warning2 = document.getElementById('warning-2');
            let clickCount = 0;

            finalButton.addEventListener('click', () => {
                // S'assurer que les autres accord√©ons sont ferm√©s
                document.querySelectorAll('.solution-content.active').forEach(openContent => {
                    if (openContent !== finalContent) { // Ne pas fermer le contenu final si d√©j√† ouvert (apr√®s 3 clics)
                        openContent.classList.remove('active');
                        openContent.style.maxHeight = null;
                    }
                });
                
                clickCount++;

                if (clickCount === 1) {
                    warning1.style.display = 'block'; // Affiche le premier avertissement
                    warning2.style.display = 'none'; // Cache le deuxi√®me s'il √©tait visible
                    finalButton.innerHTML = "<b>[CLIC N¬∞2]</b> JE SUIS VRAIMENT S√õR !";
                    finalButton.classList.add('clicked-1');
                    finalButton.classList.remove('clicked-2');
                } else if (clickCount === 2) {
                    warning1.style.display = 'block'; // Garde le premier visible
                    warning2.style.display = 'block'; // Affiche le deuxi√®me
                    finalButton.innerHTML = "<b>[CLIC FINAL]</b> R√âV√âLER LE COUPABLE";
                    finalButton.classList.add('clicked-2');
                    finalButton.classList.remove('clicked-1');
                } else if (clickCount === 3) {
                    // Tous les avertissements restent visibles, mais le bouton est d√©sactiv√© et le contenu r√©v√©l√©
                    finalContent.classList.add('active');
                    finalContent.style.maxHeight = finalContent.scrollHeight + 'px';
                    finalButton.style.pointerEvents = 'none'; // D√©sactive le bouton
                    finalButton.style.backgroundColor = '#333';
                    finalButton.style.borderColor = '#333';
                    finalButton.style.color = '#aaa';
                    finalButton.style.boxShadow = 'none';
                    finalButton.innerHTML = "<b>COUPABLE R√âV√âL√â !</b>"; // Texte final
                }
            });
        });
    </script>
</body>
</html>
